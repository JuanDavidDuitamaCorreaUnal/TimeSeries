<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PIBQuarto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="PIBQuarto - Descriptiva VF_files/libs/clipboard/clipboard.min.js"></script>
<script src="PIBQuarto - Descriptiva VF_files/libs/quarto-html/quarto.js"></script>
<script src="PIBQuarto - Descriptiva VF_files/libs/quarto-html/popper.min.js"></script>
<script src="PIBQuarto - Descriptiva VF_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="PIBQuarto - Descriptiva VF_files/libs/quarto-html/anchor.min.js"></script>
<link href="PIBQuarto - Descriptiva VF_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PIBQuarto - Descriptiva VF_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="PIBQuarto - Descriptiva VF_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="PIBQuarto - Descriptiva VF_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="PIBQuarto - Descriptiva VF_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="PIBQuarto - Descriptiva VF_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="PIBQuarto - Descriptiva VF_files/libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="PIBQuarto - Descriptiva VF_files/libs/typedarray-0.1/typedarray.min.js"></script>

<script src="PIBQuarto - Descriptiva VF_files/libs/jquery-3.5.1/jquery.min.js"></script>

<link href="PIBQuarto - Descriptiva VF_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="PIBQuarto - Descriptiva VF_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="PIBQuarto - Descriptiva VF_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="PIBQuarto - Descriptiva VF_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PIBQuarto</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>El siguiente trabajo abarca todas las metodologías vistas en el semestre 2024-1 de la asignatura Series de Tiempo Univariadas, utilizando la medición trimestral del PIB en Colombia a precios constantes (calculando el agregado a partir de la suma de las actividades económicas de Colombia), a partir del primer trimestre de 2005, hasta el último trimestre del 2023.</p>
<section id="integrantes" class="level2">
<h2 class="anchored" data-anchor-id="integrantes">Integrantes</h2>
<ul>
<li>Ander Cristancho</li>
<li>Anderson Guarin</li>
<li>Juan David Duitama</li>
</ul>
</section>
<section id="librerías-utilizadas" class="level2">
<h2 class="anchored" data-anchor-id="librerías-utilizadas">Librerías utilizadas</h2>
<div class="cell" data-messages="false">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timetk)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fable)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fabletools)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSA)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importación-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="importación-de-datos">Importación de datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>PIB3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"C:/Users/ander/OneDrive - Universidad Nacional de Colombia/Documentos/(2024-01) Octavo Semestre/Series de Tiempo Univariadas/Proyecto/1. Bases de Datos/PIB.xlsx"</span>, <span class="at">range =</span> <span class="st">"AS18:AS93"</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`</code></pre>
</div>
</div>
</section>
<section id="visualización-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="visualización-de-datos">Visualización de datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>PIB3TS <span class="ot">&lt;-</span> <span class="fu">ts</span>(PIB3, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2005</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2023</span>, <span class="dv">4</span>), <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Convirtiendo los datos originales en objeto serie de tiempo(ts)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>( <span class="at">x =</span> <span class="fu">time</span>(PIB3TS), <span class="at">y =</span> PIB3TS, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>,<span class="at">color=</span><span class="fu">I</span>(<span class="st">"red"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'PIB Trimestral en Colombia'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Trimestre'</span>, <span class="at">rangeslider =</span> <span class="fu">list</span>(<span class="at">type =</span> <span class="st">'date'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-406644398657499f2110" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-406644398657499f2110">{"x":{"visdat":{"43e0237c280c":["function () ","plotlyVisDat"]},"cur_data":"43e0237c280c","attrs":{"43e0237c280c":{"x":[2005,2005.25,2005.5,2005.75,2006,2006.25,2006.5,2006.75,2007,2007.25,2007.5,2007.75,2008,2008.25,2008.5,2008.75,2009,2009.25,2009.5,2009.75,2010,2010.25,2010.5,2010.75,2011,2011.25,2011.5,2011.75,2012,2012.25,2012.5,2012.75,2013,2013.25,2013.5,2013.75,2014,2014.25,2014.5,2014.75,2015,2015.25,2015.5,2015.75,2016,2016.25,2016.5,2016.75,2017,2017.25,2017.5,2017.75,2018,2018.25,2018.5,2018.75,2019,2019.25,2019.5,2019.75,2020,2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[126125.790850045,128871.539452182,128599.726107945,131255.94347370201,134234.01358794299,135707.55791452501,138463.56652532599,141029.86197220799,143333.19357594699,144873.706349068,147970.382545325,150279.71752966,150671.656974171,151427.83278930199,152844.15441552299,150769.355821003,150869.15385853901,152212.085496983,153922.187590018,155612.57305446101,156676.06451802299,158933.49660038401,160397.55175458401,164143.88712700899,167191.45719997,169465.15426836599,173340.340965449,174631.04756621501,177252.095049803,177496.09745117399,177258.63484234799,179408.172656674,181495.600838146,187202.11193552901,188396.73195553801,190844.55527078701,193625.433772305,193703.875145567,196329.59031789401,197930.10076423601,199315.25482117399,200450.36873025601,203018.47407064901,201907.90237792101,204357.80308589799,204811.12290935899,205774.21399403,206545.86001071299,206777.55592230099,207407.74762712,209086.25485896401,209384.441591615,210421.58731912199,213111.95825521101,215063.77884092301,215410.675584743,217863.801212416,219554.72109193099,221838.84219456301,221966.63550109,219004.41319435299,182671.279204897,201846.81715103399,214377.49044971701,222122.233502016,216849.43983676101,228933.035104582,238338.29155664201,240084.04326739599,243197.794252858,245646.19980178899,243369.96267795601,246785.26105743201,243240.73191802701,244066.68231949699,244157.55145600101],"mode":"lines","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"PIB Trimestral en Colombia","xaxis":{"domain":[0,1],"automargin":true,"title":"Trimestre","rangeslider":{"type":"date"}},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2005,2005.25,2005.5,2005.75,2006,2006.25,2006.5,2006.75,2007,2007.25,2007.5,2007.75,2008,2008.25,2008.5,2008.75,2009,2009.25,2009.5,2009.75,2010,2010.25,2010.5,2010.75,2011,2011.25,2011.5,2011.75,2012,2012.25,2012.5,2012.75,2013,2013.25,2013.5,2013.75,2014,2014.25,2014.5,2014.75,2015,2015.25,2015.5,2015.75,2016,2016.25,2016.5,2016.75,2017,2017.25,2017.5,2017.75,2018,2018.25,2018.5,2018.75,2019,2019.25,2019.5,2019.75,2020,2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[126125.790850045,128871.539452182,128599.726107945,131255.94347370201,134234.01358794299,135707.55791452501,138463.56652532599,141029.86197220799,143333.19357594699,144873.706349068,147970.382545325,150279.71752966,150671.656974171,151427.83278930199,152844.15441552299,150769.355821003,150869.15385853901,152212.085496983,153922.187590018,155612.57305446101,156676.06451802299,158933.49660038401,160397.55175458401,164143.88712700899,167191.45719997,169465.15426836599,173340.340965449,174631.04756621501,177252.095049803,177496.09745117399,177258.63484234799,179408.172656674,181495.600838146,187202.11193552901,188396.73195553801,190844.55527078701,193625.433772305,193703.875145567,196329.59031789401,197930.10076423601,199315.25482117399,200450.36873025601,203018.47407064901,201907.90237792101,204357.80308589799,204811.12290935899,205774.21399403,206545.86001071299,206777.55592230099,207407.74762712,209086.25485896401,209384.441591615,210421.58731912199,213111.95825521101,215063.77884092301,215410.675584743,217863.801212416,219554.72109193099,221838.84219456301,221966.63550109,219004.41319435299,182671.279204897,201846.81715103399,214377.49044971701,222122.233502016,216849.43983676101,228933.035104582,238338.29155664201,240084.04326739599,243197.794252858,245646.19980178899,243369.96267795601,246785.26105743201,243240.73191802701,244066.68231949699,244157.55145600101],"mode":"lines","type":"scatter","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>La conclusión inicial con este primer gráfico es que se observa la tendencia creciente del PIB, se presentó una caída súbita a partir del año 2020, ya es sabido lo que ocurrió en ese periodo. Una vez llegado el tercer trimestre de 2021, el PIB consiguió seguir la tendencia creciente que se tenía desde antes de la pandemia.</p>
</section>
<section id="autocorrelación" class="level2">
<h2 class="anchored" data-anchor-id="autocorrelación">Autocorrelación</h2>
<p>A continuación, se presenta un primer gráfico de la autocorrelación, recordemos que éste no es válido, hasta que retiremos la tendencia y la estacionalidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(PIB3TS,<span class="at">lag.max =</span> <span class="fu">length</span>(PIB3TS))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análisis-descriptivo" class="level2">
<h2 class="anchored" data-anchor-id="análisis-descriptivo">Análisis descriptivo</h2>
<p>Como ya mencionamos anteriormente, el primer componente que se puede identificar en la serie de tiempo es la tendencia creciente del PIB, aparenta haber un ciclo en el que se tienen años con PIB con tendencia a aumentar, luego, se tienen otros años en los que su tendencia disminuye. Se puede observar esto desde 2001 hasta alrededor del segundo trimestre de 2008, luego desciende, hasta empezar a crecer de nuevo, para empezar a decrecer en 2012 y crecer nuevamente en 2013.</p>
<section id="estabilización-de-la-varianza-tranformación-box-cox" class="level3">
<h3 class="anchored" data-anchor-id="estabilización-de-la-varianza-tranformación-box-cox">Estabilización de la Varianza (Tranformación Box-Cox)</h3>
<p>Primero se recurre a realizar la estabilización de la varianza de la serie, a través de la <strong>Transformación Box-Cox</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Lambda<span class="ot">&lt;-</span><span class="fu">BoxCox.lambda</span>(PIB3TS, <span class="at">method =</span><span class="st">"loglik"</span>, <span class="at">lower =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">upper =</span> <span class="dv">3</span>)<span class="co">#Encontrando el valor de Lambda</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Lambda</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.05</code></pre>
</div>
</div>
<p>El <span class="math inline">\(\lambda\)</span> resultante es cercano a 1, por lo que no será necesario realizar una transformación sobre los datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">boxcox</span>(<span class="fu">lm</span>(PIB3TS <span class="sc">~</span> <span class="dv">1</span>),<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">50</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Con el Boxcox, se confirma que <span class="math inline">\(\lambda\)</span> tiene un valor cercano a 1, pero que abarca el 0 en su intervalo de confianza.</p>
</section>
<section id="extracción-de-la-tendencia" class="level3">
<h3 class="anchored" data-anchor-id="extracción-de-la-tendencia">Extracción de la tendencia</h3>
<section id="estimación-mediante-un-modelo-lineal" class="level4">
<h4 class="anchored" data-anchor-id="estimación-mediante-un-modelo-lineal">Estimación mediante un modelo lineal</h4>
<p>A continucación, se realiza un modelo de regresión lineal simple utilizando como variable regresora el tiempo, y como variable de estudio, el PIB trimestral.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitLM <span class="ot">&lt;-</span> <span class="fu">lm</span>(PIB3TS<span class="sc">~</span><span class="fu">time</span>(PIB3TS), <span class="at">na.action=</span><span class="cn">NULL</span>))<span class="co">#Creando un modelo de regresión lineal</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PIB3TS ~ time(PIB3TS), na.action = NULL)

Residuals:
   Min     1Q Median     3Q    Max 
-41575  -2722    967   3974   7912 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -1.217e+07  3.034e+05  -40.11   &lt;2e-16 ***
time(PIB3TS)  6.135e+03  1.506e+02   40.73   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7201 on 74 degrees of freedom
Multiple R-squared:  0.9573,    Adjusted R-squared:  0.9567 
F-statistic:  1659 on 1 and 74 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PIB3TS, <span class="at">ylab=</span><span class="st">"PIB trimestral en Colombia"</span>,<span class="at">xlab=</span><span class="st">"Trimestre"</span>) </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fitLM,<span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Haciendo una revisión meramente visual, el modelo lineal resultante logra capturar el comportamiento creciente del PIB trimestral, ignorando el suceso ocurrido en 2020 claramente. La serie resultante de extraer esta tendencia lineal es la siguiente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>PIB3NoLM<span class="ot">=</span>PIB3TS<span class="sc">-</span><span class="fu">predict</span>(fitLM)<span class="co">#Eliminando la tendencia</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>( <span class="at">x =</span> <span class="fu">time</span>(PIB3NoLM), <span class="at">y =</span> PIB3NoLM, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>,<span class="at">color=</span><span class="fu">I</span>(<span class="st">"red"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'PIB trimestral en Colombia con tendencia lineal extraída'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Trimestre'</span>, <span class="at">rangeslider =</span> <span class="fu">list</span>(<span class="at">type =</span> <span class="st">'date'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-456d4c607c67e595df9f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-456d4c607c67e595df9f">{"x":{"visdat":{"43e0344a26c9":["function () ","plotlyVisDat"]},"cur_data":"43e0344a26c9","attrs":{"43e0344a26c9":{"x":[2005,2005.25,2005.5,2005.75,2006,2006.25,2006.5,2006.75,2007,2007.25,2007.5,2007.75,2008,2008.25,2008.5,2008.75,2009,2009.25,2009.5,2009.75,2010,2010.25,2010.5,2010.75,2011,2011.25,2011.5,2011.75,2012,2012.25,2012.5,2012.75,2013,2013.25,2013.5,2013.75,2014,2014.25,2014.5,2014.75,2015,2015.25,2015.5,2015.75,2016,2016.25,2016.5,2016.75,2017,2017.25,2017.5,2017.75,2018,2018.25,2018.5,2018.75,2019,2019.25,2019.5,2019.75,2020,2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[-4566.4921813497058,-3354.4076901768713,-5159.8851453780371,-4037.3318905870547,-2592.9258873102372,-2653.04567169238,-1430.7011718555586,-398.06983593959012,371.59765683524893,378.44631899209344,1941.458404284931,2717.1292776539049,1575.4046112007345,797.91631536756177,680.57383062440204,-2927.8888748597528,-4361.7549482897739,-4552.48742080995,-4376.0494387391082,-4219.328085260262,-4689.5007326643099,-3965.7327612674562,-4035.3417180316173,-1822.670456570806,-308.76449457582203,431.26846285600914,2772.7910489748465,2529.8335387767002,3617.2169113986602,2327.5552018054877,556.42848201532615,1172.3021853771643,1726.0662558831391,5898.913242301991,5559.869151346822,6474.0283556316572,7721.2427461836196,6266.0200084814569,7358.0710698442999,7424.9174052221351,7276.4073511940951,6877.8571493119525,7912.2983787407866,5268.0625750486215,6184.2991720595746,5103.9548845564132,4533.3818582632521,3771.3637639820809,2469.3955646040558,1565.9231584588997,1710.7662793387426,475.28890102557489,-21.229482433467638,1135.4773426913889,1553.6338174392295,366.86645029505598,1286.3279670020274,1443.5837355528492,2194.0407272207085,788.16992278353428,-3707.7164949194994,-41574.514595339657,-23932.640760166832,-12935.631572447979,-6724.552631115017,-13531.010407334164,-2981.0792504773417,4890.5130906185077,5102.6006904083188,6682.6875649043068,7597.4290028711257,3787.5277680739819,5669.1620365858253,590.96878621479846,-116.74492327938788,-1559.539897739538],"mode":"lines","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"PIB trimestral en Colombia con tendencia lineal extraída","xaxis":{"domain":[0,1],"automargin":true,"title":"Trimestre","rangeslider":{"type":"date"}},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2005,2005.25,2005.5,2005.75,2006,2006.25,2006.5,2006.75,2007,2007.25,2007.5,2007.75,2008,2008.25,2008.5,2008.75,2009,2009.25,2009.5,2009.75,2010,2010.25,2010.5,2010.75,2011,2011.25,2011.5,2011.75,2012,2012.25,2012.5,2012.75,2013,2013.25,2013.5,2013.75,2014,2014.25,2014.5,2014.75,2015,2015.25,2015.5,2015.75,2016,2016.25,2016.5,2016.75,2017,2017.25,2017.5,2017.75,2018,2018.25,2018.5,2018.75,2019,2019.25,2019.5,2019.75,2020,2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[-4566.4921813497058,-3354.4076901768713,-5159.8851453780371,-4037.3318905870547,-2592.9258873102372,-2653.04567169238,-1430.7011718555586,-398.06983593959012,371.59765683524893,378.44631899209344,1941.458404284931,2717.1292776539049,1575.4046112007345,797.91631536756177,680.57383062440204,-2927.8888748597528,-4361.7549482897739,-4552.48742080995,-4376.0494387391082,-4219.328085260262,-4689.5007326643099,-3965.7327612674562,-4035.3417180316173,-1822.670456570806,-308.76449457582203,431.26846285600914,2772.7910489748465,2529.8335387767002,3617.2169113986602,2327.5552018054877,556.42848201532615,1172.3021853771643,1726.0662558831391,5898.913242301991,5559.869151346822,6474.0283556316572,7721.2427461836196,6266.0200084814569,7358.0710698442999,7424.9174052221351,7276.4073511940951,6877.8571493119525,7912.2983787407866,5268.0625750486215,6184.2991720595746,5103.9548845564132,4533.3818582632521,3771.3637639820809,2469.3955646040558,1565.9231584588997,1710.7662793387426,475.28890102557489,-21.229482433467638,1135.4773426913889,1553.6338174392295,366.86645029505598,1286.3279670020274,1443.5837355528492,2194.0407272207085,788.16992278353428,-3707.7164949194994,-41574.514595339657,-23932.640760166832,-12935.631572447979,-6724.552631115017,-13531.010407334164,-2981.0792504773417,4890.5130906185077,5102.6006904083188,6682.6875649043068,7597.4290028711257,3787.5277680739819,5669.1620365858253,590.96878621479846,-116.74492327938788,-1559.539897739538],"mode":"lines","type":"scatter","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Al realizar la extracción respectiva, la serie resultante no es adecuada para continuar con el análisis, puesto que el valle resultante de la extracción en años de pandemia perjudica los próximos procedimientos. Lo cual provocaría que al realizar predicciones bajo el modelo lineal, éstas sean subajustadas.</p>
</section>
<section id="diferencia-ordinaria" class="level4">
<h4 class="anchored" data-anchor-id="diferencia-ordinaria">Diferencia ordinaria</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>DiferenciaOrd<span class="ot">&lt;-</span><span class="fu">diff</span>(PIB3TS)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>( <span class="at">x =</span> <span class="fu">time</span>(DiferenciaOrd), <span class="at">y =</span> DiferenciaOrd, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>,<span class="at">color=</span><span class="fu">I</span>(<span class="st">"red"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'PIB sin tendencia(Diferencia Ordinaria, lag=1)'</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Trimestre'</span>, <span class="at">rangeslider =</span> <span class="fu">list</span>(<span class="at">type =</span> <span class="st">'date'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5725a3a77a8ca3dab7d5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5725a3a77a8ca3dab7d5">{"x":{"visdat":{"43e058a813d3":["function () ","plotlyVisDat"]},"cur_data":"43e058a813d3","attrs":{"43e058a813d3":{"x":[2005.25,2005.5,2005.75,2006,2006.25,2006.5,2006.75,2007,2007.25,2007.5,2007.75,2008,2008.25,2008.5,2008.75,2009,2009.25,2009.5,2009.75,2010,2010.25,2010.5,2010.75,2011,2011.25,2011.5,2011.75,2012,2012.25,2012.5,2012.75,2013,2013.25,2013.5,2013.75,2014,2014.25,2014.5,2014.75,2015,2015.25,2015.5,2015.75,2016,2016.25,2016.5,2016.75,2017,2017.25,2017.5,2017.75,2018,2018.25,2018.5,2018.75,2019,2019.25,2019.5,2019.75,2020,2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[2745.7486021369987,-271.81334423700173,2656.2173657570092,2978.0701142409816,1473.5443265820213,2756.0086108009855,2566.2954468819953,2303.3316037390032,1540.5127731210086,3096.6761962570017,2309.3349843350006,391.93944451099378,756.1758151309914,1416.3216262210044,-2074.7985945199907,99.798037536005722,1342.931638443988,1710.102093035006,1690.3854644430103,1063.4914635619789,2257.4320823610178,1464.055154200003,3746.3353724249755,3047.5700729610107,2273.6970683959953,3875.1866970830015,1290.7066007660178,2621.0474835879868,244.00240137099172,-237.46260882599745,2149.5378143260023,2087.4281814720016,5706.511097383016,1194.6200200089952,2447.8233152489993,2780.8785015179892,78.441373262001434,2625.7151723270072,1600.5104463419993,1385.1540569379868,1135.1139090820216,2568.1053403929982,-1110.5716927280009,2449.9007079769799,453.31982346100267,963.09108467100305,771.64601668299292,231.69591158800176,630.19170481900801,1678.507231844007,298.18673265099642,1037.1457275069843,2690.3709360890207,1951.8205857120047,346.89674381999066,2453.1256276729982,1690.919879514986,2284.1211026320234,127.79330652698991,-2962.2223067370069,-36333.133989455993,19175.537946136988,12530.673298683017,7744.7430522989889,-5272.7936652549834,12083.595267820987,9405.2564520600135,1745.7517107539752,3113.7509854620148,2448.4055489309831,-2276.2371238329797,3415.2983794760075,-3544.529139405,825.95040146997781,90.869136504014023],"mode":"lines","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"PIB sin tendencia(Diferencia Ordinaria, lag=1)","xaxis":{"domain":[0,1],"automargin":true,"title":"Trimestre","rangeslider":{"type":"date"}},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2005.25,2005.5,2005.75,2006,2006.25,2006.5,2006.75,2007,2007.25,2007.5,2007.75,2008,2008.25,2008.5,2008.75,2009,2009.25,2009.5,2009.75,2010,2010.25,2010.5,2010.75,2011,2011.25,2011.5,2011.75,2012,2012.25,2012.5,2012.75,2013,2013.25,2013.5,2013.75,2014,2014.25,2014.5,2014.75,2015,2015.25,2015.5,2015.75,2016,2016.25,2016.5,2016.75,2017,2017.25,2017.5,2017.75,2018,2018.25,2018.5,2018.75,2019,2019.25,2019.5,2019.75,2020,2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[2745.7486021369987,-271.81334423700173,2656.2173657570092,2978.0701142409816,1473.5443265820213,2756.0086108009855,2566.2954468819953,2303.3316037390032,1540.5127731210086,3096.6761962570017,2309.3349843350006,391.93944451099378,756.1758151309914,1416.3216262210044,-2074.7985945199907,99.798037536005722,1342.931638443988,1710.102093035006,1690.3854644430103,1063.4914635619789,2257.4320823610178,1464.055154200003,3746.3353724249755,3047.5700729610107,2273.6970683959953,3875.1866970830015,1290.7066007660178,2621.0474835879868,244.00240137099172,-237.46260882599745,2149.5378143260023,2087.4281814720016,5706.511097383016,1194.6200200089952,2447.8233152489993,2780.8785015179892,78.441373262001434,2625.7151723270072,1600.5104463419993,1385.1540569379868,1135.1139090820216,2568.1053403929982,-1110.5716927280009,2449.9007079769799,453.31982346100267,963.09108467100305,771.64601668299292,231.69591158800176,630.19170481900801,1678.507231844007,298.18673265099642,1037.1457275069843,2690.3709360890207,1951.8205857120047,346.89674381999066,2453.1256276729982,1690.919879514986,2284.1211026320234,127.79330652698991,-2962.2223067370069,-36333.133989455993,19175.537946136988,12530.673298683017,7744.7430522989889,-5272.7936652549834,12083.595267820987,9405.2564520600135,1745.7517107539752,3113.7509854620148,2448.4055489309831,-2276.2371238329797,3415.2983794760075,-3544.529139405,825.95040146997781,90.869136504014023],"mode":"lines","type":"scatter","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Las conclusiones al extraer la tendencia, mediante diferencia ordinaria,</p>
</section>
<section id="comparando-las-funciones-de-autocorrelación-de-las-series-sin-tendencia" class="level4">
<h4 class="anchored" data-anchor-id="comparando-las-funciones-de-autocorrelación-de-las-series-sin-tendencia">Comparando las funciones de autocorrelación de las series sin tendencia</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(PIB3TS,<span class="at">lag.max =</span> <span class="fu">length</span>(PIB3TS))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(PIB3NoLM,<span class="at">lag.max =</span><span class="fu">length</span>(PIB3NoLM),<span class="at">main=</span><span class="st">"Autocorrelación serie sin tendencia lineal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(DiferenciaOrd,<span class="at">lag.max =</span><span class="fu">length</span>(DiferenciaOrd),<span class="at">main=</span><span class="st">"Autocorrelación serie sin tendencia</span><span class="sc">\n</span><span class="st">por diferencia ordinaria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="explorando-relaciones-no-lineales" class="level3">
<h3 class="anchored" data-anchor-id="explorando-relaciones-no-lineales">Explorando relaciones no lineales</h3>
<section id="gráficos-de-retardos" class="level4">
<h4 class="anchored" data-anchor-id="gráficos-de-retardos">Gráficos de retardos</h4>
<p>El gráfico de retardos indica que hay una relación lineal con el retardo número 4 en la serie con tendencia extraída por diferencia ordinaria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El gráfico de retardos se realiza con la serie con tendencia extraída</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Tendencia extraída por diferencia ordinaria</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lag1.plot</span>(DiferenciaOrd, <span class="dv">4</span>,<span class="at">corr=</span>T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="detección-de-estacionalidad" class="level3">
<h3 class="anchored" data-anchor-id="detección-de-estacionalidad">Detección de estacionalidad</h3>
<p>Un primer gráfico propuesto para la detección de la estacionalidad de forma visual es el siguiente, recordemos que está siendo aplicado en la serie con la tendencia extraída.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tendencia extraída por diferencia ordinaria</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>TSstudio<span class="sc">::</span><span class="fu">ts_heatmap</span>(DiferenciaOrd,<span class="at">title =</span> <span class="st">"Mapa de Calor - PIB en Colombia(Diferencia Ordinaria)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2ed8f86d49b4009d50dc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2ed8f86d49b4009d50dc">{"x":{"visdat":{"43e0d7207":["function () ","plotlyVisDat"]},"cur_data":"43e0d7207","attrs":{"43e0d7207":{"z":[[null,2978.0701142409816,2303.3316037390032,391.93944451099378,99.798037536005722,1063.4914635619789,3047.5700729610107,2621.0474835879868,2087.4281814720016,2780.8785015179892,1385.1540569379868,2449.9007079769799,231.69591158800176,1037.1457275069843,2453.1256276729982,-2962.2223067370069,7744.7430522989889,1745.7517107539752,3415.2983794760075],[2745.7486021369987,1473.5443265820213,1540.5127731210086,756.1758151309914,1342.931638443988,2257.4320823610178,2273.6970683959953,244.00240137099172,5706.511097383016,78.441373262001434,1135.1139090820216,453.31982346100267,630.19170481900801,2690.3709360890207,1690.919879514986,-36333.133989455993,-5272.7936652549834,3113.7509854620148,-3544.529139405],[-271.81334423700173,2756.0086108009855,3096.6761962570017,1416.3216262210044,1710.102093035006,1464.055154200003,3875.1866970830015,-237.46260882599745,1194.6200200089952,2625.7151723270072,2568.1053403929982,963.09108467100305,1678.507231844007,1951.8205857120047,2284.1211026320234,19175.537946136988,12083.595267820987,2448.4055489309831,825.95040146997781],[2656.2173657570092,2566.2954468819953,2309.3349843350006,-2074.7985945199907,1690.3854644430103,3746.3353724249755,1290.7066007660178,2149.5378143260023,2447.8233152489993,1600.5104463419993,-1110.5716927280009,771.64601668299292,298.18673265099642,346.89674381999066,127.79330652698991,12530.673298683017,9405.2564520600135,-2276.2371238329797,90.869136504014023]],"x":["2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023"],"y":[1,2,3,4],"colorscale":[[0,"#F7FBFF"],[0.55955834000569304,"#59A1CE"],[0.59069337648891673,"#4E9ACA"],[0.60118375235926091,"#4B97C9"],[0.61354191476855036,"#4695C7"],[0.61717087079089439,"#4594C7"],[0.63454161428320477,"#408FC5"],[0.6496520163022661,"#3D8BC3"],[0.65027085177811506,"#3C8BC3"],[0.65596192618275118,"#3B8AC2"],[0.65618581486191885,"#3B8AC2"],[0.65634667082767406,"#3B8AC2"],[0.65685101128502588,"#3B89C2"],[0.65872283782019447,"#3A89C1"],[0.65894454173336448,"#3A89C1"],[0.65992068346745014,"#3A89C1"],[0.66079820421277646,"#3A88C1"],[0.66160965761492718,"#3A88C1"],[0.66271543760946972,"#3A88C1"],[0.66590182047885693,"#3987C0"],[0.66817144981638033,"#3886C0"],[0.66845014863969121,"#3886C0"],[0.66942845316209076,"#3886C0"],[0.67189907042636532,"#3785C0"],[0.67323317985924647,"#3785BF"],[0.67370780364569849,"#3785BF"],[0.67499809654989817,"#3785BF"],[0.67607011122529914,"#3684BF"],[0.67780113049501811,"#3684BF"],[0.67874197515688595,"#3684BF"],[0.67950262060239375,"#3583BF"],[0.68006411069387318,"#3583BF"],[0.68092403989618566,"#3583BE"],[0.6810949892641156,"#3583BE"],[0.68230143943133792,"#3583BE"],[0.6833823097013132,"#3482BE"],[0.68478743763506211,"#3482BE"],[0.68500142640807371,"#3482BE"],[0.6850110540041473,"#3482BE"],[0.68535662547705656,"#3482BE"],[0.68599886058151616,"#3482BE"],[0.68971123322118466,"#3381BD"],[0.69215423160380396,"#3280BD"],[0.69327314925555505,"#3280BD"],[0.69521688640999835,"#317FBC"],[0.69550990343720898,"#317FBC"],[0.69569769453133068,"#317FBC"],[0.69604377561086495,"#317FBC"],[0.69615192773172563,"#317FBC"],[0.69864682314328741,"#317EBC"],[0.69865731220133331,"#317EBC"],[0.69868424779524796,"#317EBC"],[0.69874234537862667,"#317EBC"],[0.70078112265905423,"#307EBC"],[0.7008137282582857,"#307EBC"],[0.70176749172170305,"#307EBC"],[0.70185158108245083,"#307EBC"],[0.70240108429278514,"#307DBB"],[0.70301636779968724,"#2F7DBB"],[0.70401400770201161,"#2F7DBB"],[0.7041988438421356,"#2F7DBB"],[0.70464687997504583,"#2F7DBB"],[0.70819932693237519,"#2E7CBB"],[0.70945138280574704,"#2E7CBB"],[0.7103360395915006,"#2D7BBA"],[0.71064364538730895,"#2D7BBA"],[0.7160760829416406,"#2C7ABA"],[0.72203978161079763,"#2A78B9"],[0.72436106439716175,"#2978B8"],[0.75735274545241937,"#206FB4"],[0.79407190813173811,"#1A66AC"],[0.82398639431666665,"#155EA6"],[0.87223721211444549,"#09529D"],[0.88029141365219399,"#08509A"],[1,"#08306B"]],"hoverinfo":"text","text":[["Value:  NA <br> Year :  2005 <br> Quarter  : 1","Value:  2978.07011424098 <br> Year :  2006 <br> Quarter  : 1","Value:  2303.331603739 <br> Year :  2007 <br> Quarter  : 1","Value:  391.939444510994 <br> Year :  2008 <br> Quarter  : 1","Value:  99.7980375360057 <br> Year :  2009 <br> Quarter  : 1","Value:  1063.49146356198 <br> Year :  2010 <br> Quarter  : 1","Value:  3047.57007296101 <br> Year :  2011 <br> Quarter  : 1","Value:  2621.04748358799 <br> Year :  2012 <br> Quarter  : 1","Value:  2087.428181472 <br> Year :  2013 <br> Quarter  : 1","Value:  2780.87850151799 <br> Year :  2014 <br> Quarter  : 1","Value:  1385.15405693799 <br> Year :  2015 <br> Quarter  : 1","Value:  2449.90070797698 <br> Year :  2016 <br> Quarter  : 1","Value:  231.695911588002 <br> Year :  2017 <br> Quarter  : 1","Value:  1037.14572750698 <br> Year :  2018 <br> Quarter  : 1","Value:  2453.125627673 <br> Year :  2019 <br> Quarter  : 1","Value:  -2962.22230673701 <br> Year :  2020 <br> Quarter  : 1","Value:  7744.74305229899 <br> Year :  2021 <br> Quarter  : 1","Value:  1745.75171075398 <br> Year :  2022 <br> Quarter  : 1","Value:  3415.29837947601 <br> Year :  2023 <br> Quarter  : 1"],["Value:  2745.748602137 <br> Year :  2005 <br> Quarter  : 2","Value:  1473.54432658202 <br> Year :  2006 <br> Quarter  : 2","Value:  1540.51277312101 <br> Year :  2007 <br> Quarter  : 2","Value:  756.175815130991 <br> Year :  2008 <br> Quarter  : 2","Value:  1342.93163844399 <br> Year :  2009 <br> Quarter  : 2","Value:  2257.43208236102 <br> Year :  2010 <br> Quarter  : 2","Value:  2273.697068396 <br> Year :  2011 <br> Quarter  : 2","Value:  244.002401370992 <br> Year :  2012 <br> Quarter  : 2","Value:  5706.51109738302 <br> Year :  2013 <br> Quarter  : 2","Value:  78.4413732620014 <br> Year :  2014 <br> Quarter  : 2","Value:  1135.11390908202 <br> Year :  2015 <br> Quarter  : 2","Value:  453.319823461003 <br> Year :  2016 <br> Quarter  : 2","Value:  630.191704819008 <br> Year :  2017 <br> Quarter  : 2","Value:  2690.37093608902 <br> Year :  2018 <br> Quarter  : 2","Value:  1690.91987951499 <br> Year :  2019 <br> Quarter  : 2","Value:  -36333.133989456 <br> Year :  2020 <br> Quarter  : 2","Value:  -5272.79366525498 <br> Year :  2021 <br> Quarter  : 2","Value:  3113.75098546201 <br> Year :  2022 <br> Quarter  : 2","Value:  -3544.529139405 <br> Year :  2023 <br> Quarter  : 2"],["Value:  -271.813344237002 <br> Year :  2005 <br> Quarter  : 3","Value:  2756.00861080099 <br> Year :  2006 <br> Quarter  : 3","Value:  3096.676196257 <br> Year :  2007 <br> Quarter  : 3","Value:  1416.321626221 <br> Year :  2008 <br> Quarter  : 3","Value:  1710.10209303501 <br> Year :  2009 <br> Quarter  : 3","Value:  1464.0551542 <br> Year :  2010 <br> Quarter  : 3","Value:  3875.186697083 <br> Year :  2011 <br> Quarter  : 3","Value:  -237.462608825997 <br> Year :  2012 <br> Quarter  : 3","Value:  1194.620020009 <br> Year :  2013 <br> Quarter  : 3","Value:  2625.71517232701 <br> Year :  2014 <br> Quarter  : 3","Value:  2568.105340393 <br> Year :  2015 <br> Quarter  : 3","Value:  963.091084671003 <br> Year :  2016 <br> Quarter  : 3","Value:  1678.50723184401 <br> Year :  2017 <br> Quarter  : 3","Value:  1951.820585712 <br> Year :  2018 <br> Quarter  : 3","Value:  2284.12110263202 <br> Year :  2019 <br> Quarter  : 3","Value:  19175.537946137 <br> Year :  2020 <br> Quarter  : 3","Value:  12083.595267821 <br> Year :  2021 <br> Quarter  : 3","Value:  2448.40554893098 <br> Year :  2022 <br> Quarter  : 3","Value:  825.950401469978 <br> Year :  2023 <br> Quarter  : 3"],["Value:  2656.21736575701 <br> Year :  2005 <br> Quarter  : 4","Value:  2566.295446882 <br> Year :  2006 <br> Quarter  : 4","Value:  2309.334984335 <br> Year :  2007 <br> Quarter  : 4","Value:  -2074.79859451999 <br> Year :  2008 <br> Quarter  : 4","Value:  1690.38546444301 <br> Year :  2009 <br> Quarter  : 4","Value:  3746.33537242498 <br> Year :  2010 <br> Quarter  : 4","Value:  1290.70660076602 <br> Year :  2011 <br> Quarter  : 4","Value:  2149.537814326 <br> Year :  2012 <br> Quarter  : 4","Value:  2447.823315249 <br> Year :  2013 <br> Quarter  : 4","Value:  1600.510446342 <br> Year :  2014 <br> Quarter  : 4","Value:  -1110.571692728 <br> Year :  2015 <br> Quarter  : 4","Value:  771.646016682993 <br> Year :  2016 <br> Quarter  : 4","Value:  298.186732650996 <br> Year :  2017 <br> Quarter  : 4","Value:  346.896743819991 <br> Year :  2018 <br> Quarter  : 4","Value:  127.79330652699 <br> Year :  2019 <br> Quarter  : 4","Value:  12530.673298683 <br> Year :  2020 <br> Quarter  : 4","Value:  9405.25645206001 <br> Year :  2021 <br> Quarter  : 4","Value:  -2276.23712383298 <br> Year :  2022 <br> Quarter  : 4","Value:  90.869136504014 <br> Year :  2023 <br> Quarter  : 4"]],"xgap":3,"ygap":3,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Mapa de Calor - PIB en Colombia(Diferencia Ordinaria)","xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Quarter"},"scene":{"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#F7FBFF"],[0.55955834000569304,"#59A1CE"],[0.59069337648891673,"#4E9ACA"],[0.60118375235926091,"#4B97C9"],[0.61354191476855036,"#4695C7"],[0.61717087079089439,"#4594C7"],[0.63454161428320477,"#408FC5"],[0.6496520163022661,"#3D8BC3"],[0.65027085177811506,"#3C8BC3"],[0.65596192618275118,"#3B8AC2"],[0.65618581486191885,"#3B8AC2"],[0.65634667082767406,"#3B8AC2"],[0.65685101128502588,"#3B89C2"],[0.65872283782019447,"#3A89C1"],[0.65894454173336448,"#3A89C1"],[0.65992068346745014,"#3A89C1"],[0.66079820421277646,"#3A88C1"],[0.66160965761492718,"#3A88C1"],[0.66271543760946972,"#3A88C1"],[0.66590182047885693,"#3987C0"],[0.66817144981638033,"#3886C0"],[0.66845014863969121,"#3886C0"],[0.66942845316209076,"#3886C0"],[0.67189907042636532,"#3785C0"],[0.67323317985924647,"#3785BF"],[0.67370780364569849,"#3785BF"],[0.67499809654989817,"#3785BF"],[0.67607011122529914,"#3684BF"],[0.67780113049501811,"#3684BF"],[0.67874197515688595,"#3684BF"],[0.67950262060239375,"#3583BF"],[0.68006411069387318,"#3583BF"],[0.68092403989618566,"#3583BE"],[0.6810949892641156,"#3583BE"],[0.68230143943133792,"#3583BE"],[0.6833823097013132,"#3482BE"],[0.68478743763506211,"#3482BE"],[0.68500142640807371,"#3482BE"],[0.6850110540041473,"#3482BE"],[0.68535662547705656,"#3482BE"],[0.68599886058151616,"#3482BE"],[0.68971123322118466,"#3381BD"],[0.69215423160380396,"#3280BD"],[0.69327314925555505,"#3280BD"],[0.69521688640999835,"#317FBC"],[0.69550990343720898,"#317FBC"],[0.69569769453133068,"#317FBC"],[0.69604377561086495,"#317FBC"],[0.69615192773172563,"#317FBC"],[0.69864682314328741,"#317EBC"],[0.69865731220133331,"#317EBC"],[0.69868424779524796,"#317EBC"],[0.69874234537862667,"#317EBC"],[0.70078112265905423,"#307EBC"],[0.7008137282582857,"#307EBC"],[0.70176749172170305,"#307EBC"],[0.70185158108245083,"#307EBC"],[0.70240108429278514,"#307DBB"],[0.70301636779968724,"#2F7DBB"],[0.70401400770201161,"#2F7DBB"],[0.7041988438421356,"#2F7DBB"],[0.70464687997504583,"#2F7DBB"],[0.70819932693237519,"#2E7CBB"],[0.70945138280574704,"#2E7CBB"],[0.7103360395915006,"#2D7BBA"],[0.71064364538730895,"#2D7BBA"],[0.7160760829416406,"#2C7ABA"],[0.72203978161079763,"#2A78B9"],[0.72436106439716175,"#2978B8"],[0.75735274545241937,"#206FB4"],[0.79407190813173811,"#1A66AC"],[0.82398639431666665,"#155EA6"],[0.87223721211444549,"#09529D"],[0.88029141365219399,"#08509A"],[1,"#08306B"]],"showscale":true,"z":[[null,2978.0701142409816,2303.3316037390032,391.93944451099378,99.798037536005722,1063.4914635619789,3047.5700729610107,2621.0474835879868,2087.4281814720016,2780.8785015179892,1385.1540569379868,2449.9007079769799,231.69591158800176,1037.1457275069843,2453.1256276729982,-2962.2223067370069,7744.7430522989889,1745.7517107539752,3415.2983794760075],[2745.7486021369987,1473.5443265820213,1540.5127731210086,756.1758151309914,1342.931638443988,2257.4320823610178,2273.6970683959953,244.00240137099172,5706.511097383016,78.441373262001434,1135.1139090820216,453.31982346100267,630.19170481900801,2690.3709360890207,1690.919879514986,-36333.133989455993,-5272.7936652549834,3113.7509854620148,-3544.529139405],[-271.81334423700173,2756.0086108009855,3096.6761962570017,1416.3216262210044,1710.102093035006,1464.055154200003,3875.1866970830015,-237.46260882599745,1194.6200200089952,2625.7151723270072,2568.1053403929982,963.09108467100305,1678.507231844007,1951.8205857120047,2284.1211026320234,19175.537946136988,12083.595267820987,2448.4055489309831,825.95040146997781],[2656.2173657570092,2566.2954468819953,2309.3349843350006,-2074.7985945199907,1690.3854644430103,3746.3353724249755,1290.7066007660178,2149.5378143260023,2447.8233152489993,1600.5104463419993,-1110.5716927280009,771.64601668299292,298.18673265099642,346.89674381999066,127.79330652698991,12530.673298683017,9405.2564520600135,-2276.2371238329797,90.869136504014023]],"x":["2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023"],"y":[1,2,3,4],"hoverinfo":"text","text":[["Value:  NA <br> Year :  2005 <br> Quarter  : 1","Value:  2978.07011424098 <br> Year :  2006 <br> Quarter  : 1","Value:  2303.331603739 <br> Year :  2007 <br> Quarter  : 1","Value:  391.939444510994 <br> Year :  2008 <br> Quarter  : 1","Value:  99.7980375360057 <br> Year :  2009 <br> Quarter  : 1","Value:  1063.49146356198 <br> Year :  2010 <br> Quarter  : 1","Value:  3047.57007296101 <br> Year :  2011 <br> Quarter  : 1","Value:  2621.04748358799 <br> Year :  2012 <br> Quarter  : 1","Value:  2087.428181472 <br> Year :  2013 <br> Quarter  : 1","Value:  2780.87850151799 <br> Year :  2014 <br> Quarter  : 1","Value:  1385.15405693799 <br> Year :  2015 <br> Quarter  : 1","Value:  2449.90070797698 <br> Year :  2016 <br> Quarter  : 1","Value:  231.695911588002 <br> Year :  2017 <br> Quarter  : 1","Value:  1037.14572750698 <br> Year :  2018 <br> Quarter  : 1","Value:  2453.125627673 <br> Year :  2019 <br> Quarter  : 1","Value:  -2962.22230673701 <br> Year :  2020 <br> Quarter  : 1","Value:  7744.74305229899 <br> Year :  2021 <br> Quarter  : 1","Value:  1745.75171075398 <br> Year :  2022 <br> Quarter  : 1","Value:  3415.29837947601 <br> Year :  2023 <br> Quarter  : 1"],["Value:  2745.748602137 <br> Year :  2005 <br> Quarter  : 2","Value:  1473.54432658202 <br> Year :  2006 <br> Quarter  : 2","Value:  1540.51277312101 <br> Year :  2007 <br> Quarter  : 2","Value:  756.175815130991 <br> Year :  2008 <br> Quarter  : 2","Value:  1342.93163844399 <br> Year :  2009 <br> Quarter  : 2","Value:  2257.43208236102 <br> Year :  2010 <br> Quarter  : 2","Value:  2273.697068396 <br> Year :  2011 <br> Quarter  : 2","Value:  244.002401370992 <br> Year :  2012 <br> Quarter  : 2","Value:  5706.51109738302 <br> Year :  2013 <br> Quarter  : 2","Value:  78.4413732620014 <br> Year :  2014 <br> Quarter  : 2","Value:  1135.11390908202 <br> Year :  2015 <br> Quarter  : 2","Value:  453.319823461003 <br> Year :  2016 <br> Quarter  : 2","Value:  630.191704819008 <br> Year :  2017 <br> Quarter  : 2","Value:  2690.37093608902 <br> Year :  2018 <br> Quarter  : 2","Value:  1690.91987951499 <br> Year :  2019 <br> Quarter  : 2","Value:  -36333.133989456 <br> Year :  2020 <br> Quarter  : 2","Value:  -5272.79366525498 <br> Year :  2021 <br> Quarter  : 2","Value:  3113.75098546201 <br> Year :  2022 <br> Quarter  : 2","Value:  -3544.529139405 <br> Year :  2023 <br> Quarter  : 2"],["Value:  -271.813344237002 <br> Year :  2005 <br> Quarter  : 3","Value:  2756.00861080099 <br> Year :  2006 <br> Quarter  : 3","Value:  3096.676196257 <br> Year :  2007 <br> Quarter  : 3","Value:  1416.321626221 <br> Year :  2008 <br> Quarter  : 3","Value:  1710.10209303501 <br> Year :  2009 <br> Quarter  : 3","Value:  1464.0551542 <br> Year :  2010 <br> Quarter  : 3","Value:  3875.186697083 <br> Year :  2011 <br> Quarter  : 3","Value:  -237.462608825997 <br> Year :  2012 <br> Quarter  : 3","Value:  1194.620020009 <br> Year :  2013 <br> Quarter  : 3","Value:  2625.71517232701 <br> Year :  2014 <br> Quarter  : 3","Value:  2568.105340393 <br> Year :  2015 <br> Quarter  : 3","Value:  963.091084671003 <br> Year :  2016 <br> Quarter  : 3","Value:  1678.50723184401 <br> Year :  2017 <br> Quarter  : 3","Value:  1951.820585712 <br> Year :  2018 <br> Quarter  : 3","Value:  2284.12110263202 <br> Year :  2019 <br> Quarter  : 3","Value:  19175.537946137 <br> Year :  2020 <br> Quarter  : 3","Value:  12083.595267821 <br> Year :  2021 <br> Quarter  : 3","Value:  2448.40554893098 <br> Year :  2022 <br> Quarter  : 3","Value:  825.950401469978 <br> Year :  2023 <br> Quarter  : 3"],["Value:  2656.21736575701 <br> Year :  2005 <br> Quarter  : 4","Value:  2566.295446882 <br> Year :  2006 <br> Quarter  : 4","Value:  2309.334984335 <br> Year :  2007 <br> Quarter  : 4","Value:  -2074.79859451999 <br> Year :  2008 <br> Quarter  : 4","Value:  1690.38546444301 <br> Year :  2009 <br> Quarter  : 4","Value:  3746.33537242498 <br> Year :  2010 <br> Quarter  : 4","Value:  1290.70660076602 <br> Year :  2011 <br> Quarter  : 4","Value:  2149.537814326 <br> Year :  2012 <br> Quarter  : 4","Value:  2447.823315249 <br> Year :  2013 <br> Quarter  : 4","Value:  1600.510446342 <br> Year :  2014 <br> Quarter  : 4","Value:  -1110.571692728 <br> Year :  2015 <br> Quarter  : 4","Value:  771.646016682993 <br> Year :  2016 <br> Quarter  : 4","Value:  298.186732650996 <br> Year :  2017 <br> Quarter  : 4","Value:  346.896743819991 <br> Year :  2018 <br> Quarter  : 4","Value:  127.79330652699 <br> Year :  2019 <br> Quarter  : 4","Value:  12530.673298683 <br> Year :  2020 <br> Quarter  : 4","Value:  9405.25645206001 <br> Year :  2021 <br> Quarter  : 4","Value:  -2276.23712383298 <br> Year :  2022 <br> Quarter  : 4","Value:  90.869136504014 <br> Year :  2023 <br> Quarter  : 4"]],"xgap":3,"ygap":3,"type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthplot</span>(DiferenciaOrd,<span class="at">main=</span><span class="st">"Subseries(Diferencia Ordinaria)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Otra alternativa es utilizar los gráficos de cajas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>indice1<span class="ot">=</span><span class="fu">as.Date</span>(<span class="fu">as.yearmon</span>(<span class="fu">tk_index</span>(PIB3TS)))<span class="co">#Convirtiendo en fecha el indice de DesempleoTSBox, deja como primero de enero cada fecha</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>indice1<span class="fl">.1</span><span class="ot">=</span><span class="fu">yearmon</span>(<span class="fu">as.yearmon</span>(<span class="fu">tk_index</span>(PIB3TS)))<span class="co">#Dejando esa fecha solo como año y mes</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Haciendo el objeto tsibble</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Fecha=</span>indice1,<span class="at">PIB=</span><span class="fu">as.matrix</span>(PIB3TS))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df)[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="st">"PIB"</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>PIB3TSibble<span class="ot">=</span><span class="fu">as_tsibble</span>(df)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using `Fecha` as index variable.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Haciendo el objeto tsibble</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Fecha=</span>indice1,<span class="at">PIB=</span><span class="fu">as.matrix</span>(PIB3TS))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df)[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="st">"PIB"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>PIB3TSibble<span class="ot">=</span><span class="fu">as_tsibble</span>(df)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using `Fecha` as index variable.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>PIB3TSibble <span class="ot">&lt;-</span> PIB3TSibble <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">as.Date</span>(Fecha))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>PIB3TSibble<span class="ot">&lt;-</span>PIB3TSibble<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">Diferencia=</span>PIB<span class="sc">-</span><span class="fu">lag</span>(PIB))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>PIB3TSibble <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_seasonal_diagnostics</span>(<span class="at">.date_var =</span> index, <span class="at">.value =</span> Diferencia, <span class="at">.feature_set =</span> <span class="fu">c</span>(<span class="st">"quarter"</span>), <span class="at">.geom =</span> <span class="st">"boxplot"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9c20022d2c3e62847dbb" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9c20022d2c3e62847dbb">{"x":{"data":[{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[2745.7486021369987,1135.1139090820216,244.00240137099172,1342.931638443988,1473.5443265820213,453.31982346100267,5706.511097383016,2257.4320823610178,1540.5127731210086,630.19170481900801,78.441373262001434,2273.6970683959953,756.1758151309914,2690.3709360890207,3113.7509854620148,1690.919879514986,-3544.529139405,-36333.133989455993,-5272.7936652549834,-271.81334423700173,2568.1053403929982,2756.0086108009855,963.09108467100305,3096.6761962570017,1678.507231844007,2625.7151723270072,1416.3216262210044,1951.8205857120047,-237.46260882599745,1710.102093035006,2284.1211026320234,1194.6200200089952,1464.055154200003,19175.537946136988,3875.1866970830015,12083.595267820987,2448.4055489309831,825.95040146997781,2656.2173657570092,2566.2954468819953,2309.3349843350006,298.18673265099642,-2074.7985945199907,346.89674381999066,-1110.5716927280009,1690.3854644430103,127.79330652698991,771.64601668299292,3746.3353724249755,12530.673298683017,1600.5104463419993,1290.7066007660178,9405.2564520600135,2149.5378143260023,-2276.2371238329797,2447.8233152489993,90.869136504014023,391.93944451099378,99.798037536005722,2978.0701142409816,1063.4914635619789,2303.3316037390032,3047.5700729610107,7744.7430522989889,1037.1457275069843,1385.1540569379868,2621.0474835879868,1745.7517107539752,2453.1256276729982,2449.9007079769799,2087.4281814720016,3415.2983794760075,-2962.2223067370069,231.69591158800176,2780.8785015179892],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(44,62,80,1)","width":1.8897637795275593},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":55.452054794520549,"r":7.3059360730593621,"b":25.570776255707766,"l":46.027397260273986},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.611872146118724},"title":{"text":"Seasonal Diagnostics","font":{"color":"rgba(44,62,80,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["1","2","3","4"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["1","2","3","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.6529680365296811,"tickwidth":0.22139200221392005,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392005,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-39108.567586235644,21950.971542916639],"tickmode":"array","ticktext":["-20000","0","20000"],"tickvals":[-20000,0,20000],"categoryorder":"array","categoryarray":["-20000","0","20000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.6529680365296811,"tickwidth":0.22139200221392005,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392005,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088001,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(44,62,80,1)","line":{"color":"rgba(44,62,80,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.973017849730184,"yanchor":1,"ysizemode":"pixel"}],"annotations":[{"text":"quarter","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(255,255,255,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"43e02dbe2c27":{"x":{},"y":{},"type":"box"}},"cur_data":"43e02dbe2c27","visdat":{"43e02dbe2c27":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Finalmente, un gráfico con las estimaciones de las densidades.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PIB3TSibble <span class="sc">%&gt;%</span><span class="fu">na.omit</span>()<span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">Trimestre =</span> <span class="fu">str_c</span>(<span class="st">"Trimestre "</span>, <span class="fu">as.character</span>(lubridate<span class="sc">::</span><span class="fu">quarter</span>(index)))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    ), <span class="fu">aes</span>(<span class="at">x =</span> Diferencia)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Trimestre)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="st">"LosPass - Estimación de la densidad vía Kernel por trimestre"</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(<span class="fu">as.factor</span>(Trimestre)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="encontrando-el-periodo-de-la-serie" class="level4">
<h4 class="anchored" data-anchor-id="encontrando-el-periodo-de-la-serie">Encontrando el periodo de la serie</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Diferencia ordinaria</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>PeriodgramadTra<span class="ot">=</span><span class="fu">spectrum</span>(<span class="fu">as.numeric</span>(DiferenciaOrd),<span class="at">log=</span><span class="st">'no'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ubicacion<span class="ot">=</span><span class="fu">which.max</span>(PeriodgramadTra<span class="sc">$</span>spec)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"El valor de la frecuencia donde se máximiza el periodograma para la serie con tendencia extraída por diferencia ordinaria es: %s"</span>,PeriodgramadTra<span class="sc">$</span>freq[ubicacion])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El valor de la frecuencia donde se máximiza el periodograma para la serie con tendencia extraída por diferencia ordinaria es: 0.226666666666667"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"El periodo correspondiente es aproximadamente: %s"</span>,<span class="dv">1</span><span class="sc">/</span>PeriodgramadTra<span class="sc">$</span>freq[ubicacion])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El periodo correspondiente es aproximadamente: 4.41176470588235"</code></pre>
</div>
</div>
<p>De acuerdo a la información reportada en el gráfico de periodograma, no es necesario modelar la estacionalidad.</p>
</section>
</section>
</section>
<section id="suavizamiento-exponencial" class="level2">
<h2 class="anchored" data-anchor-id="suavizamiento-exponencial">Suavizamiento Exponencial</h2>
<p>El suavizamiento exponencial es un modelo que contiene 3 parámetros, dos relacionados a la estimación de la componente de tendencia, y el tercero a la componente de estacionalidad. Teniendo en cuenta que para este conjunto de datos no se requiere modelar la estacionalidad, solo se tendrán en cuenta los parámetros correspondientes a la compente de tendencia.</p>
<span class="math display">\[\begin{align*}
a_t &amp; = \alpha(x_t-s_{t-p}) + (1-\alpha)(a_{t-1}+b_{t-1}) \\
b_t &amp; = \beta(a_t-a_{t-1}) + (1-\beta)b_{t-1} \\
\end{align*}\]</span>
<p>El siguiente modelo se manejará con los datos originales, por lo tanto, para evaluar la capacidad predictiva del modelo, utilizando la predicción a un paso, emplearemos el 80% de la serie como conjunto de entrenamiento y el 20% restante como prueba. Es decir, el periodo de entrenamiento corresponde a los primeros 61 trimestres, es decir, de enero de 2005 hasta marzo de 2020, por otro lado, el periodo de prueba corresponde a abril de 2020 hasta diciembre de 2023.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Train<span class="ot">=</span><span class="fu">ts</span>(PIB3TS[<span class="dv">1</span><span class="sc">:</span><span class="dv">61</span>], <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2005</span>, <span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">4</span>) </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Test<span class="ot">=</span><span class="fu">ts</span>(PIB3TS[<span class="dv">62</span><span class="sc">:</span><span class="dv">76</span>],<span class="at">start=</span><span class="fu">c</span>(<span class="dv">2020</span>,<span class="dv">2</span>),<span class="at">frequency =</span> <span class="dv">4</span>) </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>HWAP<span class="ot">=</span>stats<span class="sc">::</span><span class="fu">HoltWinters</span>(Train,<span class="at">gamma=</span><span class="dv">0</span>) </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="fu">time</span>(PIB3TS[<span class="dv">5</span><span class="sc">:</span><span class="dv">61</span>]), <span class="at">y =</span> PIB3TS[<span class="dv">5</span><span class="sc">:</span><span class="dv">61</span>], <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"Original"</span>) <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> HWAP<span class="sc">$</span>fitted[,<span class="dv">1</span>], <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>), <span class="at">name =</span> <span class="st">"EWMA"</span>) <span class="sc">%&gt;%</span>   <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Suavizamiento Exponencial'</span>,<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Trimestre'</span>, <span class="at">rangeslider =</span> <span class="fu">list</span>(<span class="at">type =</span> <span class="st">'date'</span>))) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b0e5694cc3bbd9b8e605" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b0e5694cc3bbd9b8e605">{"x":{"visdat":{"43e02a3441a9":["function () ","plotlyVisDat"]},"cur_data":"43e02a3441a9","attrs":{"43e02a3441a9":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],"y":[134234.01358794299,135707.55791452501,138463.56652532599,141029.86197220799,143333.19357594699,144873.706349068,147970.382545325,150279.71752966,150671.656974171,151427.83278930199,152844.15441552299,150769.355821003,150869.15385853901,152212.085496983,153922.187590018,155612.57305446101,156676.06451802299,158933.49660038401,160397.55175458401,164143.88712700899,167191.45719997,169465.15426836599,173340.340965449,174631.04756621501,177252.095049803,177496.09745117399,177258.63484234799,179408.172656674,181495.600838146,187202.11193552901,188396.73195553801,190844.55527078701,193625.433772305,193703.875145567,196329.59031789401,197930.10076423601,199315.25482117399,200450.36873025601,203018.47407064901,201907.90237792101,204357.80308589799,204811.12290935899,205774.21399403,206545.86001071299,206777.55592230099,207407.74762712,209086.25485896401,209384.441591615,210421.58731912199,213111.95825521101,215063.77884092301,215410.675584743,217863.801212416,219554.72109193099,221838.84219456301,221966.63550109,219004.41319435299],"mode":"lines","name":"Original","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"43e02a3441a9.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],"y":[130475.12921486645,135603.66944688227,137366.84299750888,141672.53945075604,144303.78948231268,144678.80549391935,146514.250377491,151181.55555666535,153540.74499494472,151893.75216863304,152906.35704276949,155804.8410468073,153539.04769725242,151611.51962164568,153273.01966423547,156506.73252841859,158247.41984188801,157347.59213813744,159981.00391492154,162955.11610405543,166873.11640716653,168067.47148789873,170706.1814117523,176220.63550001429,177521.1244312317,178254.73347897356,178738.10964414739,179900.23127675336,182123.49956570665,182302.57959311368,188578.14072097128,191247.97750812769,193774.69574519608,194675.11412426061,194980.54183441482,199170.64670037507,200801.27659956767,200228.08349477022,201659.72508016165,205792.78531952045,204558.25934151054,205124.7170642243,205843.34125898901,208288.19125368306,209060.71992858575,207287.62275168207,208208.38970370294,211423.83287552692,211705.5939010632,210796.1629924571,213905.04110862274,217410.16282823437,217742.95889562281,218331.36217462504,220377.13783461531,224232.21258697787,224330.40134725167],"mode":"lines","name":"EWMA","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"color":"blue"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Suavizamiento Exponencial","xaxis":{"domain":[0,1],"automargin":true,"title":"Trimestre","rangeslider":{"type":"date"}},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],"y":[134234.01358794299,135707.55791452501,138463.56652532599,141029.86197220799,143333.19357594699,144873.706349068,147970.382545325,150279.71752966,150671.656974171,151427.83278930199,152844.15441552299,150769.355821003,150869.15385853901,152212.085496983,153922.187590018,155612.57305446101,156676.06451802299,158933.49660038401,160397.55175458401,164143.88712700899,167191.45719997,169465.15426836599,173340.340965449,174631.04756621501,177252.095049803,177496.09745117399,177258.63484234799,179408.172656674,181495.600838146,187202.11193552901,188396.73195553801,190844.55527078701,193625.433772305,193703.875145567,196329.59031789401,197930.10076423601,199315.25482117399,200450.36873025601,203018.47407064901,201907.90237792101,204357.80308589799,204811.12290935899,205774.21399403,206545.86001071299,206777.55592230099,207407.74762712,209086.25485896401,209384.441591615,210421.58731912199,213111.95825521101,215063.77884092301,215410.675584743,217863.801212416,219554.72109193099,221838.84219456301,221966.63550109,219004.41319435299],"mode":"lines","name":"Original","type":"scatter","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],"y":[130475.12921486645,135603.66944688227,137366.84299750888,141672.53945075604,144303.78948231268,144678.80549391935,146514.250377491,151181.55555666535,153540.74499494472,151893.75216863304,152906.35704276949,155804.8410468073,153539.04769725242,151611.51962164568,153273.01966423547,156506.73252841859,158247.41984188801,157347.59213813744,159981.00391492154,162955.11610405543,166873.11640716653,168067.47148789873,170706.1814117523,176220.63550001429,177521.1244312317,178254.73347897356,178738.10964414739,179900.23127675336,182123.49956570665,182302.57959311368,188578.14072097128,191247.97750812769,193774.69574519608,194675.11412426061,194980.54183441482,199170.64670037507,200801.27659956767,200228.08349477022,201659.72508016165,205792.78531952045,204558.25934151054,205124.7170642243,205843.34125898901,208288.19125368306,209060.71992858575,207287.62275168207,208208.38970370294,211423.83287552692,211705.5939010632,210796.1629924571,213905.04110862274,217410.16282823437,217742.95889562281,218331.36217462504,220377.13783461531,224232.21258697787,224330.40134725167],"mode":"lines","name":"EWMA","type":"scatter","line":{"color":"blue"},"marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ajustados<span class="ot">=</span><span class="fu">fitted</span>(HWAP)<span class="co">#Guarda las estimaciones que hace el modelo para cada trimestre desde enero de 2004 hasta marzo de 2020 </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ajustados)<span class="co">#Gráfico de las tres componentes, nivel, pendiente y estacionalidad </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>HWAP</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Holt-Winters exponential smoothing with trend and additive seasonal component.

Call:
stats::HoltWinters(x = Train, gamma = 0)

Smoothing parameters:
 alpha: 1
 beta : 0.05826555
 gamma: 0

Coefficients:
            [,1]
a  218116.778629
b    1162.856487
s1    -93.540972
s2   -791.140404
s3     -2.953189
s4    887.634566</code></pre>
</div>
</div>
<p>La estimación del parámetro de Nivel alpha es 0.8704311, de Pendiente beta 0.08945198 y de estacionalidad gamma 1.</p>
<p>Por último evaluaremos la capacidad predictiva del modelo haciendo las 15 predicciones para el periodo correspondiente a prueba. Abril de 2020 hasta diciembre de 2023.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>predictionHWAP_1<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">forecast</span>(HWAP,<span class="at">h=</span><span class="dv">15</span>) </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>predictionHWAP_1 </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
2020 Q2       219186.1 216828.9 221543.3 215581.1 222791.1
2020 Q3       219651.4 216219.3 223083.4 214402.4 224900.3
2020 Q4       221602.4 217277.3 225927.5 214987.8 228217.0
2021 Q1       223655.8 218520.2 228791.5 215801.6 231510.1
2021 Q2       223837.5 217936.4 229738.6 214812.6 232862.5
2021 Q3       224302.8 217662.9 230942.7 214147.9 234457.7
2021 Q4       226253.8 218891.1 233616.5 214993.6 237514.1
2022 Q1       228307.3 220231.2 236383.3 215956.0 240658.5
2022 Q2       228488.9 219704.5 237273.4 215054.3 241923.5
2022 Q3       228954.2 219463.3 238445.1 214439.1 243469.3
2022 Q4       230905.2 220707.4 241103.1 215309.0 246501.5
2023 Q1       232958.7 222052.0 243865.4 216278.3 249639.1
2023 Q2       233140.4 221521.4 244759.3 215370.7 250910.0
2023 Q3       233605.6 221270.3 245941.0 214740.3 252471.0
2023 Q4       235556.7 222499.9 248613.5 215588.0 255525.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(predictionHWAP_1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PIBQuarto---Descriptiva-VF_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El error cuadrático medio es</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((Test<span class="sc">-</span>predictionHWAP_1<span class="sc">$</span>mean)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 212455066</code></pre>
</div>
</div>
<p>Recordemos que el error cuadrático medio es alto debido a que los datos se encuentran en la escala original.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="fu">time</span>(Test), <span class="at">y =</span> Test, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"PIB"</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_trace</span>(<span class="at">y =</span> predictionHWAP_1<span class="sc">$</span>mean, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>), <span class="at">name =</span> <span class="st">"Predicciones"</span>) <span class="sc">%&gt;%</span>   <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'PIB vs Predicciones (Abril 2020-Diciembre 2023)'</span>,<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Trimestre'</span>, <span class="at">rangeslider =</span> <span class="fu">list</span>(<span class="at">type =</span> <span class="st">'date'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8f040f75a042ef5ab926" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8f040f75a042ef5ab926">{"x":{"visdat":{"43e040cd4e27":["function () ","plotlyVisDat"]},"cur_data":"43e040cd4e27","attrs":{"43e040cd4e27":{"x":[2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[182671.279204897,201846.81715103399,214377.49044971701,222122.233502016,216849.43983676101,228933.035104582,238338.29155664201,240084.04326739599,243197.794252858,245646.19980178899,243369.96267795601,246785.26105743201,243240.73191802701,244066.68231949699,244157.55145600101],"mode":"lines","name":"PIB","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"43e040cd4e27.1":{"x":[2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[219186.09414323285,219651.35119791806,221602.39490042866,223655.83914148778,223837.5200903677,224302.77714505285,226253.8208475635,228307.26508862263,228488.94603750249,228954.2030921877,230905.24679469829,232958.69103575748,233140.37198463734,233605.62903932249,235556.67274183314],"mode":"lines","name":"Predicciones","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"color":"blue"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"PIB vs Predicciones (Abril 2020-Diciembre 2023)","xaxis":{"domain":[0,1],"automargin":true,"title":"Trimestre","rangeslider":{"type":"date"}},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[182671.279204897,201846.81715103399,214377.49044971701,222122.233502016,216849.43983676101,228933.035104582,238338.29155664201,240084.04326739599,243197.794252858,245646.19980178899,243369.96267795601,246785.26105743201,243240.73191802701,244066.68231949699,244157.55145600101],"mode":"lines","name":"PIB","type":"scatter","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[219186.09414323285,219651.35119791806,221602.39490042866,223655.83914148778,223837.5200903677,224302.77714505285,226253.8208475635,228307.26508862263,228488.94603750249,228954.2030921877,230905.24679469829,232958.69103575748,233140.37198463734,233605.62903932249,235556.67274183314],"mode":"lines","name":"Predicciones","type":"scatter","line":{"color":"blue"},"marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Rolling</strong></p>
<section id="rolling-manual" class="level5">
<h5 class="anchored" data-anchor-id="rolling-manual">Rolling manual</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>h<span class="ot">=</span><span class="dv">1</span>  </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>lserie<span class="ot">=</span><span class="fu">length</span>(PIB3TS) </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ntrain<span class="ot">=</span><span class="fu">trunc</span>(<span class="fu">length</span>(PIB3TS)<span class="sc">*</span><span class="fl">0.80</span>)<span class="sc">+</span><span class="dv">1</span> <span class="do">##% del datos en el conjunto de entrenamiento es del 80%. </span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>ntrain </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">time</span>(PIB3TS) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Qtr1    Qtr2    Qtr3    Qtr4
2005 2005.00 2005.25 2005.50 2005.75
2006 2006.00 2006.25 2006.50 2006.75
2007 2007.00 2007.25 2007.50 2007.75
2008 2008.00 2008.25 2008.50 2008.75
2009 2009.00 2009.25 2009.50 2009.75
2010 2010.00 2010.25 2010.50 2010.75
2011 2011.00 2011.25 2011.50 2011.75
2012 2012.00 2012.25 2012.50 2012.75
2013 2013.00 2013.25 2013.50 2013.75
2014 2014.00 2014.25 2014.50 2014.75
2015 2015.00 2015.25 2015.50 2015.75
2016 2016.00 2016.25 2016.50 2016.75
2017 2017.00 2017.25 2017.50 2017.75
2018 2018.00 2018.25 2018.50 2018.75
2019 2019.00 2019.25 2019.50 2019.75
2020 2020.00 2020.25 2020.50 2020.75
2021 2021.00 2021.25 2021.50 2021.75
2022 2022.00 2022.25 2022.50 2022.75
2023 2023.00 2023.25 2023.50 2023.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">time</span>(PIB3TS)[ntrain]<span class="do">###Me entrega la ultima fecha de la posición ntrain #Partiendo la serie en entrenamiento y test </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2020</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>train<span class="ot">=</span><span class="fu">window</span>(PIB3TS,<span class="at">end=</span><span class="fu">time</span>(PIB3TS)[ntrain]) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span><span class="fu">window</span>(PIB3TS,<span class="at">start=</span><span class="fu">time</span>(PIB3TS)[ntrain]<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)<span class="do">##1/4 porque es la fracción que corresponde a un trimestre </span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(train) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ntest<span class="ot">=</span><span class="fu">length</span>(test) </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ntest <span class="do">##Me define el valor de origins, o de ventanas de rolling. </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>lserie <span class="do">### Comparar los valores </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fchstepahe<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>ntest,<span class="at">ncol=</span>h) <span class="do">##Crea una Columna para los h-pasos adelante </span><span class="al">###</span><span class="do"> verval contiene los verdaderos valores de la serie en el conjunto de prueba con los que se compararán los pronósticos. </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>verval<span class="ot">=</span><span class="fu">cbind</span>(test[<span class="dv">1</span><span class="sc">:</span>ntest]) <span class="co">#for(j in 2:h){  # verval=cbind(verval,c(test[j:ntest],rep(NA,j-1))) ##### Este for sobra porque sólo hacemos predicción un paso adelante #}  #verval=cbind(test[1:ntest],c(test[2:ntest],NA),c(test[3:ntest],NA,NA)) ####Ajuste del modelo con los datos de entrenamiento </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>HWAP_train<span class="ot">=</span>stats<span class="sc">::</span><span class="fu">HoltWinters</span>(train,<span class="at">gamma =</span> <span class="dv">0</span>) </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>HWAP_train<span class="sc">$</span>alpha </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>alpha 
    1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>HWAP_train<span class="sc">$</span>beta </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      beta 
0.05826555 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>HWAP_train<span class="sc">$</span>gamma <span class="do">###Observación: Note que que esos son las estimaciones de los parámetros de suavizamiento. Se puede también hacer una grilla de valores para explorar si hay unos valores mejores. # por ejemplo como sigue: </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(utils) </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>suav_inputs<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.999</span>,<span class="fl">0.1</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.999</span>,<span class="fl">0.1</span>)) </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(suav_inputs)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"alpha"</span>,<span class="st">"beta"</span>) </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>suav_inputs_tbl<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(suav_inputs) </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>grilla_suav<span class="ot">=</span><span class="fu">expand.grid</span>(<span class="at">alpha=</span>suav_inputs_tbl<span class="sc">$</span>alpha,<span class="at">beta=</span>suav_inputs_tbl<span class="sc">$</span>beta) <span class="do">##Grilla de Valores ####Se crean las ventanas de rolling y se obtiene los h-pronósticos para cada ventana(hay ntest posibles ventanas) </span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(ntest)){x<span class="ot">=</span><span class="fu">window</span>(PIB3TS,<span class="at">end=</span><span class="fu">time</span>(PIB3TS)[ntrain]<span class="sc">+</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">12</span>)   </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(x))   </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>refit<span class="ot">=</span>stats<span class="sc">::</span><span class="fu">HoltWinters</span>(x,<span class="at">seasonal=</span><span class="cn">NULL</span>,<span class="at">alpha=</span>HWAP_train<span class="sc">$</span>alpha,<span class="at">bet=</span>HWAP_train<span class="sc">$</span>beta)     </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  fchstepahe[i,]<span class="ot">=</span><span class="fu">as.numeric</span>(forecast<span class="sc">::</span><span class="fu">forecast</span>(refit,<span class="at">h=</span>h)<span class="sc">$</span>mean) } </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61
[1] 61
[1] 61
[1] 62
[1] 62
[1] 62
[1] 63
[1] 63
[1] 63
[1] 64
[1] 64
[1] 64
[1] 65
[1] 65
[1] 65</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>fchstepahe  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
 [1,] 219186.1
 [2,] 219186.1
 [3,] 219186.1
 [4,] 181009.0
 [5,] 181009.0
 [6,] 181009.0
 [7,] 202884.4
 [8,] 202884.4
 [9,] 202884.4
[10,] 216187.2
[11,] 216187.2
[12,] 216187.2
[13,] 222405.9
[14,] 222405.9
[15,] 222405.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>errores_pred<span class="ot">=</span>verval <span class="sc">-</span>fchstepahe <span class="do">##Observación: debo devolver los pronósticos y los verdaderos valores a la escala original si es necesario. </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>ECM<span class="ot">=</span><span class="fu">apply</span>(errores_pred<span class="sc">^</span><span class="dv">2</span>,<span class="at">MARGIN =</span> <span class="dv">2</span>,mean,<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="do">##Acá se computa la medida de precisión del pronóstico(en este caso ECM). </span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>RECM<span class="ot">=</span><span class="fu">sqrt</span>(ECM) <span class="do">##Se le saca raíz  #RECM ##se lee: Primera fila RECM 1-paso adelante y así sucesivamente. </span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>ECM</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1007600296</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="fu">time</span>(test), <span class="at">y =</span> test, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"PIB"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">y =</span> fchstepahe, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>), <span class="at">name =</span> <span class="st">"Predicciones"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'PIB vs Predicciones (Abril 2020-Diciembre 2023)'</span>,          <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Trimestre'</span>, <span class="at">rangeslider =</span> <span class="fu">list</span>(<span class="at">type =</span> <span class="st">'date'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-58d57119d58ca0f8e390" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-58d57119d58ca0f8e390">{"x":{"visdat":{"43e02ce341e3":["function () ","plotlyVisDat"]},"cur_data":"43e02ce341e3","attrs":{"43e02ce341e3":{"x":[2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[182671.279204897,201846.81715103399,214377.49044971701,222122.233502016,216849.43983676101,228933.035104582,238338.29155664201,240084.04326739599,243197.794252858,245646.19980178899,243369.96267795601,246785.26105743201,243240.73191802701,244066.68231949699,244157.55145600101],"mode":"lines","name":"PIB","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"43e02ce341e3.1":{"x":[2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[[219186.09414323288],[219186.09414323288],[219186.09414323288],[181008.98064804383],[181008.98064804383],[181008.98064804383],[202884.43315307808],[202884.43315307808],[202884.43315307808],[216187.15624326322],[216187.15624326322],[216187.15624326322],[222405.94651750158],[222405.94651750158],[222405.94651750158]],"mode":"lines","name":"Predicciones","color":["red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"color":"blue"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"PIB vs Predicciones (Abril 2020-Diciembre 2023)","xaxis":{"domain":[0,1],"automargin":true,"title":"Trimestre","rangeslider":{"type":"date"}},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[182671.279204897,201846.81715103399,214377.49044971701,222122.233502016,216849.43983676101,228933.035104582,238338.29155664201,240084.04326739599,243197.794252858,245646.19980178899,243369.96267795601,246785.26105743201,243240.73191802701,244066.68231949699,244157.55145600101],"mode":"lines","name":"PIB","type":"scatter","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2020.25,2020.5,2020.75,2021,2021.25,2021.5,2021.75,2022,2022.25,2022.5,2022.75,2023,2023.25,2023.5,2023.75],"y":[219186.09414323288,219186.09414323288,219186.09414323288,181008.98064804383,181008.98064804383,181008.98064804383,202884.43315307808,202884.43315307808,202884.43315307808,216187.15624326322,216187.15624326322,216187.15624326322,222405.94651750158,222405.94651750158,222405.94651750158],"mode":"lines","name":"Predicciones","type":"scatter","line":{"color":"blue"},"marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="rolling-usando-la-función" class="level5">
<h5 class="anchored" data-anchor-id="rolling-usando-la-función">Rolling usando la función</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(greybox) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'greybox':
  method     from
  print.pcor lava</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Package "greybox", v2.0.1 loaded.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'greybox'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:fabletools':

    MAE, MAPE, MASE, ME, MPE, MSE, RMSSE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tsibble':

    measures</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lubridate':

    hm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    spread</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>HWAP_train<span class="ot">=</span>stats<span class="sc">::</span><span class="fu">HoltWinters</span>(train,<span class="at">gamma=</span><span class="dv">0</span>)   </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>h<span class="ot">=</span><span class="dv">1</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>ourCallETS <span class="ot">&lt;-</span> <span class="st">"forecast::forecast(stats::HoltWinters(x=data,alpha=HWAP_train$alpha,beta=HWAP_train$beta),h=h)"</span> <span class="do">###Note que x=data es solo un argumento indeterminado. </span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>ourValueETS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mean"</span>,<span class="st">"lower"</span>,<span class="st">"upper"</span>) </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>origins<span class="ot">=</span>ntest   <span class="do">##número de rolling windows </span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>Valoresretornados1 <span class="ot">&lt;-</span> <span class="fu">ro</span>(PIB3TS, <span class="at">h=</span>h, <span class="at">origins=</span>origins, <span class="at">call=</span>ourCallETS, <span class="at">value=</span>ourValueETS,<span class="at">ci=</span><span class="cn">FALSE</span>,<span class="at">co=</span><span class="cn">FALSE</span>) </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(Valoresretornados1<span class="sc">$</span>holdout)<span class="do">## Permiten verificar los verdaderos valores h-pasos adelante.  </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               h1
origin62 182671.3
origin63 201846.8
origin64 214377.5
origin65 222122.2
origin66 216849.4
origin67 228933.0
origin68 238338.3
origin69 240084.0
origin70 243197.8
origin71 245646.2
origin72 243370.0
origin73 246785.3
origin74 243240.7
origin75 244066.7
origin76 244157.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(Valoresretornados1<span class="sc">$</span>mean) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               h1
origin62 219186.1
origin63 181009.0
origin64 202884.4
origin65 216187.2
origin66 222405.9
origin67 217093.0
origin68 231352.2
origin69 241266.9
origin70 241072.0
origin71 244593.2
origin72 248588.7
origin73 246110.8
origin74 247693.7
origin75 244173.2
origin76 246478.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>((Valoresretornados1<span class="sc">$</span>holdout <span class="sc">-</span>Valoresretornados1<span class="sc">$</span>mean)<span class="sc">^</span><span class="dv">2</span>,<span class="dv">1</span>,mean,<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="do">### Se calcula el error cuadrático medio de predicción  </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       h1 
147644997 </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>